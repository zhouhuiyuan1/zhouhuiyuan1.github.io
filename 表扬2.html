<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>建设银行表扬卡</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: #f8f9fa;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23e5e7eb' fill-opacity='0.4' fill-rule='evenodd'/%3E%3C/svg%3E");
        }
        
        .praise-card {
            background: linear-gradient(135deg, #c51e3a 0%, #8c0c23 100%);
            box-shadow: 0 15px 35px rgba(140, 12, 35, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .praise-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(90deg, #d4af37, #f0e68c, #d4af37);
        }
        
        .praise-card::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(90deg, #d4af37, #f0e68c, #d4af37);
        }
        
        .gold-border {
            border: 2px solid #d4af37;
            position: relative;
        }
        
        .gold-border::before {
            content: "";
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 20px;
            background: #c51e3a;
            border-top: 2px solid #d4af37;
            border-left: 2px solid #d4af37;
            border-right: 2px solid #d4af37;
            border-radius: 8px 8px 0 0;
        }
        
        .gold-border::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 20px;
            background: #c51e3a;
            border-bottom: 2px solid #d4af37;
            border-left: 2px solid #d4af37;
            border-right: 2px solid #d4af37;
            border-radius: 0 0 8px 8px;
        }
        
        .star {
            color: #d4af37;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.6);
        }
        
        .editable-field {
            background: transparent;
            border: none;
            outline: none;
            color: #fff;
            font-family: 'Noto Serif SC', serif;
            transition: all 0.3s ease;
            border-radius: 4px;
            min-height: 2rem;
            width: 100%;
        }
        
        .editable-field:focus {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #d4af37;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }
        
        .editable-field::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .seal {
            position: absolute;
            right: 20px;
            bottom: 20px;
            width: 80px;
            height: 80px;
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid #d4af37;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: rotate(15deg);
        }
        
        .seal::before {
            content: "建设银行";
            color: #d4af37;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            line-height: 1.2;
        }
        
        @media (max-width: 768px) {
            .praise-card {
                margin: 1rem;
                padding: 1.5rem;
            }
            
            .seal {
                width: 60px;
                height: 60px;
                right: 10px;
                bottom: 10px;
            }
            
            .seal::before {
                font-size: 12px;
            }
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .btn-save {
            background: linear-gradient(135deg, #d4af37, #f0e68c);
            color: #8c0c23;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            font-size: 1.1rem;
        }
        
        .btn-save:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }
        
        .btn-save:active {
            transform: translateY(0);
        }
        
        .btn-save:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        .text-gold {
            color: #d4af37;
            text-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
        }
        
        .logo-container {
            position: relative;
            overflow: hidden;
        }
        
        .logo-container::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #d4af37, transparent);
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-content {
            background: #fff;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .loading-spinner {
            border: 4px solid rgba(212, 175, 55, 0.3);
            border-radius: 50%;
            border-top: 4px solid #d4af37;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-message {
            position: fixed;
            top: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 1rem 2rem;
            border-radius: 25px;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.3);
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
        }
        
        .success-message.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="praise-card rounded-lg p-6 md:p-10 w-full max-w-3xl animate-float mb-8">
        <!-- Logo -->
        <div class="logo-container flex justify-center mb-8 pb-4">
            <div class="w-32 h-16 bg-white rounded-md flex items-center justify-center shadow-lg">
                <span class="text-[#c51e3a] font-bold text-2xl">武威民勤支行</span>
            </div>
        </div>
        
        <!-- 标题 -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">表扬卡</h1>
            <div class="flex justify-center space-x-4">
                <i class="fas fa-star star text-xl"></i>
                <i class="fas fa-star star text-xl"></i>
                <i class="fas fa-star star text-xl"></i>
            </div>
        </div>
        
        <!-- 主要内容 -->
        <div class="gold-border rounded-lg p-6 md:p-8 bg-opacity-20 bg-white backdrop-blur-sm">
            <p class="text-white text-lg md:text-xl mb-6">
                在我行开展的"优质服务月"活动中，<span class="font-bold text-gold">
                    <div contenteditable="true" class="editable-field inline-block min-w-[100px]" placeholder="被表扬人姓名"></div>
                </span>同志表现突出，特此表扬。
            </p>
            
            <p class="text-white text-lg md:text-xl mb-6">
                该同志在工作中<span class="font-bold text-gold">
                    <div contenteditable="true" class="editable-field min-h-[6rem]" placeholder="表扬事由..."></div>
                </span>
            </p>
            
            <p class="text-white text-lg md:text-xl">
                希望该同志再接再厉，继续保持良好的工作作风，为我行的发展做出更大贡献！
            </p>
        </div>
        
        <!-- 日期和印章 -->
        <div class="mt-8 flex justify-between items-end">
            <div>
                <p class="text-white text-lg">中国建设银行</p>
                <p class="text-white mt-2">
                    <span contenteditable="true" class="editable-field inline-block min-w-[120px]" placeholder="年 月 日"></span>
                </p>
            </div>
            
            <div class="seal"></div>
        </div>
    </div>
    
    <!-- 保存按钮 -->
    <div class="mt-4 flex justify-center">
        <button id="saveBtn" class="btn-save">
            <i class="fas fa-save mr-2"></i>保存表扬卡
        </button>
    </div>
    
    <!-- 加载覆盖层 -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>正在生成表扬卡...</p>
        </div>
    </div>
    
    <!-- 成功消息 -->
    <div id="successMessage" class="success-message">
        <i class="fas fa-check-circle mr-2"></i>表扬卡已成功保存！
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化默认日期
            const dateElement = document.querySelector('.editable-field[placeholder="年 月 日"]');
            if (dateElement) {
                const now = new Date();
                const year = now.getFullYear();
                const month = now.getMonth() + 1;
                const day = now.getDate();
                dateElement.textContent = `${year}年${month}月${day}日`;
            }
            
            // 获取DOM元素
            const saveBtn = document.getElementById('saveBtn');
            const loadingOverlay = document.getElementById('loadingOverlay');
            const successMessage = document.getElementById('successMessage');
            
            // 保存按钮点击事件
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    // 显示加载状态
                    loadingOverlay.classList.add('active');
                    saveBtn.disabled = true;
                    
                    // 延迟执行以显示加载效果
                    setTimeout(() => {
                        // 使用html2canvas生成图片
                        html2canvas(document.querySelector('.praise-card'), {
                            scale: 2, // 提高图片质量
                            useCORS: true,
                            logging: false
                        }).then(canvas => {
                            // 创建下载链接
                            const link = document.createElement('a');
                            
                            // 设置文件名
                            const now = new Date();
                            const year = now.getFullYear();
                            const month = String(now.getMonth() + 1).padStart(2, '0');
                            const day = String(now.getDate()).padStart(2, '0');
                            const filename = `建行表扬卡_${year}${month}${day}.jpg`;
                            
                            // 设置下载属性
                            link.download = filename;
                            link.href = canvas.toDataURL('image/jpeg', 0.9); // 0.9是图片质量
                            
                            // 触发下载
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            
                            // 隐藏加载状态
                            loadingOverlay.classList.remove('active');
                            
                            // 显示成功消息
                            successMessage.classList.add('active');
                            
                            // 3秒后隐藏成功消息
                            setTimeout(() => {
                                successMessage.classList.remove('active');
                                saveBtn.disabled = false;
                            }, 3000);
                        }).catch(error => {
                            console.error('保存失败:', error);
                            loadingOverlay.classList.remove('active');
                            saveBtn.disabled = false;
                            alert('保存失败，请重试！');
                        });
                    }, 1000);
                });
            }
            
            // 为所有可编辑字段添加焦点和失焦事件
            const editableFields = document.querySelectorAll('.editable-field');
            editableFields.forEach(field => {
                field.addEventListener('focus', function() {
                    if (this.textContent === this.getAttribute('placeholder')) {
                        this.textContent = '';
                    }
                });
                
                field.addEventListener('blur', function() {
                    if (this.textContent.trim() === '') {
                        this.textContent = this.getAttribute('placeholder');
                    }
                });
            });
        });
    </script>
</body>
</html>
